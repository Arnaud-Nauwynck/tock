



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Build assistants & chatbots with ease.">
      
      
        <link rel="canonical" href="https://theopenconversationkit.github.io/tock/en/admin/architecture/">
      
      
        <meta name="author" content="Tock">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Architecture de Tock - Tock</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.30686662.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#architecture-de-tock" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://theopenconversationkit.github.io/tock/en" title="Tock" class="md-header-nav__button md-logo">
          
            <img src="../../assets/images/logo.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Tock
            </span>
            <span class="md-header-nav__topic">
              
                Architecture de Tock
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/theopenconversationkit/tock" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    tock
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://theopenconversationkit.github.io/tock/en" title="Tock" class="md-nav__button md-logo">
      
        <img src="../../assets/images/logo.svg" width="48" height="48">
      
    </a>
    Tock
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/theopenconversationkit/tock" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    tock
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../getting-started/" title="TLDR;" class="md-nav__link">
      TLDR;
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Try Tock Studio
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Try Tock Studio
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../guide/studio/" title="Create your 1st bot" class="md-nav__link">
      Create your 1st bot
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../build-nlp-model/" title="Build NLP models" class="md-nav__link">
      Build NLP models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../evaluate-the-model/" title="Monitor NLP models" class="md-nav__link">
      Monitor NLP models
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Develop Stories
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Develop Stories
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../code-a-bot/" title="Bot API mode" class="md-nav__link">
      Bot API mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../the-open-data-bot/" title="Integrated Bot mode" class="md-nav__link">
      Integrated Bot mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../i18n/" title="Multilingual (i18n)" class="md-nav__link">
      Multilingual (i18n)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../api/" title="APIs" class="md-nav__link">
      APIs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kdoc/" title="KDoc" class="md-nav__link">
      KDoc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/why/" title="Why Tock" class="md-nav__link">
      Why Tock
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/showcase/" title="Showcase" class="md-nav__link">
      Showcase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/resources/" title="Resources" class="md-nav__link">
      Resources
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contact/" title="Contact us" class="md-nav__link">
      Contact us
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/community/" title="Community" class="md-nav__link">
      Community
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/contribute/" title="Contribute" class="md-nav__link">
      Contribute
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/jobs/" title="Jobs" class="md-nav__link">
      Jobs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://theopenconversationkit.github.io/tock/fr/" title="🇬🇧 🇫🇷" class="md-nav__link">
      🇬🇧 🇫🇷
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#architecture-fonctionnelle" class="md-nav__link">
    Architecture fonctionnelle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture-technique" class="md-nav__link">
    Architecture technique
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#base-de-donnees-mongodb" class="md-nav__link">
    Base de données MongoDB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composants-applicatifs" class="md-nav__link">
    Composants applicatifs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modes-de-deploiement" class="md-nav__link">
    Modes de déploiement
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#voir-aussi" class="md-nav__link">
    Voir aussi...
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="architecture-de-tock">Architecture de Tock<a class="headerlink" href="#architecture-de-tock" title="Permanent link">&para;</a></h1>
<p>Ce chapitre présente l'architecture générale d'une plateforme Tock : composants et dépendances,
flux, configuration de proxies, etc.</p>
<h2 id="architecture-fonctionnelle">Architecture fonctionnelle<a class="headerlink" href="#architecture-fonctionnelle" title="Permanent link">&para;</a></h2>
<p>Deux composants majeurs sont disponibles :</p>
<ul>
<li>le moteur <em>NLU</em> : <em>Natural Language Understanding</em> (voir <a href="../../utilisateur/studio/"><em>Tock Studio</em></a>)</li>
<li>le framework conversationnel intégré aux services <em>NLU</em> et à différents connecteurs comme 
 Messenger, Google Assistant ou Slack (voir <a href="../../dev/modes/">manuel développeur</a> et <a href="../../utilisateur/channels/">connecteurs</a>).</li>
</ul>
<p><img alt="schéma Tock" src="../../img/tock.png" title="Les différentes composantes de Tock" /></p>
<p>La plateforme NLU est indépendante de la partie conversationnelle. Il est possible d'utiliser le NLU sans devoir 
maîtriser la complexité induite par la gestion des conversations. Dans certain cas d'usage importants, comme l'<a href="https://fr.wikipedia.org/wiki/Internet_des_objets">Internet des objets</a>, 
l'utilisation d'un modèle NLU seule est pertinente.</p>
<h2 id="architecture-technique">Architecture technique<a class="headerlink" href="#architecture-technique" title="Permanent link">&para;</a></h2>
<p>Tock est composé de plusieurs composants applicatifs (<em>conteneurs</em> lorsqu'on utilise Docker) 
et d'une base de donnée <a href="https://www.mongodb.com">MongoDB</a>.</p>
<blockquote>
<p>Les descripteurs <a href="https://www.docker.com/">Docker</a> et <a href="https://docs.docker.com/compose/">Docker Compose</a> fournis 
(ie. les <code>Dockerfile</code> et <code>docker-compose.yml</code>) décrivent l'architecture de Tock.</p>
<p>Un exemple complet se trouve dans le fichier <a href="https://github.com/theopenconversationkit/tock-docker/blob/master/docker-compose-bot-open-data.yml"><code>docker-compose-bot-open-data.yml</code></a> 
disponible dans le dépôt <a href="https://github.com/theopenconversationkit/tock-docker"><code>tock-docker</code></a>. </p>
</blockquote>
<h3 id="base-de-donnees-mongodb">Base de données MongoDB<a class="headerlink" href="#base-de-donnees-mongodb" title="Permanent link">&para;</a></h3>
<p>La base Mongo doit être configurée en <em>replica set</em>, c'est à dire avec au minimum 3 instances déployées.
C'est obligatoire car Tock utilise la fonctionnalité des <a href="https://docs.mongodb.com/manual/changeStreams/">Change Streams</a>
qui a comme pré-requis l'installation en replica set.</p>
<p>Il s'agit également d'une bonne pratique afin d'assurer une haute disponibilité de la base de données. </p>
<h3 id="composants-applicatifs">Composants applicatifs<a class="headerlink" href="#composants-applicatifs" title="Permanent link">&para;</a></h3>
<p>Voici une description rapide des différents composants applicatifs (et images <a href="https://www.docker.com/">Docker</a> fournies 
avec Tock) :</p>
<ul>
<li>
<p>Interfaces et outils <em>Tock Studio</em> :</p>
<ul>
<li><a href="https://hub.docker.com/r/tock/bot_admin"><code>tock/bot_admin</code></a> : <em>Tock Studio</em></li>
</ul>
</li>
<li>
<p>Partie <em>NLU</em> :</p>
<ul>
<li><a href="https://hub.docker.com/r/tock/build_worker"><code>tock/build_worker</code></a> : reconstruit les modèles automatiquement dès que nécessaire</li>
<li><a href="https://hub.docker.com/r/tock/duckling"><code>tock/duckling</code></a> : analyse les dates et types primitifs en utilisant <a href="https://duckling.wit.ai">Duckling</a></li>
<li><a href="https://hub.docker.com/r/tock/nlp_api"><code>tock/nlp_api</code></a> : analyse les phrases à partir des modèles
construits dans <em>Tock Studio</em></li>
</ul>
</li>
<li>
<p>Partie conversationnelle :</p>
<ul>
<li><a href="https://hub.docker.com/r/tock/bot_api"><code>tock/bot_api</code></a> : API pour développer des bots (mode <a href="../../dev/bot-api/"><em>Tock Bot API</em></a>)</li>
<li><a href="https://hub.docker.com/r/tock/kotlin_compiler"><code>tock/kotlin_compiler</code></a> (facultatif) : compilateur de scripts 
pour les saisir directement dans l'interface <a href="../../utilisateur/studio/build/"><em>Build</em></a> de <em>Tock Studio</em></li>
</ul>
</li>
</ul>
<p>Un dernier composant, le bot lui-même, doit être ajouté et rendu accessible aux partenaires et canaux externes auxquels 
 on souhaite s'intégrer.</p>
<blockquote>
<p>Bien entendu l'implémentation du bot n'est pas fournie avec Tock (chacun implémente ses fonctionnalités propres pour son besoin) 
mais un exemple est disponible dans 
<a href="https://github.com/theopenconversationkit/tock-docker/blob/master/docker-compose-bot-open-data.yml"><code>docker-compose-bot-open-data.yml</code></a>.</p>
</blockquote>
<h3 id="modes-de-deploiement">Modes de déploiement<a class="headerlink" href="#modes-de-deploiement" title="Permanent link">&para;</a></h3>
<ul>
<li>Le mode <em>plateforme NLU</em> seul (sans partie conversationnelle) :</li>
</ul>
<p><img alt="Schéma NLU" src="../../img/nlp_api.png" title="Schéma NLU" /></p>
<ul>
<li>Le mode <em>Tock Bot API</em> (recommandé pour la plupart des cas), permettant de développer en <a href="https://kotlinlang.org/">Kotlin</a> 
ou un autre langage à travers l'API conversationnelle de Tock :</li>
</ul>
<p><img alt="BOT API" src="../../img/bot_api.png" title="BOT API" /></p>
<ul>
<li>Le mode <em>Tock Bot intégré</em> (historique) permettant de développer en <a href="https://kotlinlang.org/">Kotlin</a> uniquement 
en utilisant toutes les possibilités de Tock mais en accédant à la base MongoDB directement depuis le bot :</li>
</ul>
<p><img alt="Bot TOCK" src="../../img/bot_open_data.png" title="Bot Tock" /></p>
<h2 id="voir-aussi">Voir aussi...<a class="headerlink" href="#voir-aussi" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="../installation/">Installation</a></li>
<li><a href="../security/">Sécurité</a></li>
<li><a href="../monitoring/">Supervision</a></li>
<li><a href="../cloud/">Cloud</a></li>
<li><a href="../availability/">Haute disponibilité</a></li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017/2019 Tock
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/theopenconversationkit/tock" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>